!function(){var e,n,t,s;"undefined"==typeof drupalSettings||void 0===drupalSettings.neg_analytics||void 0===drupalSettings.neg_analytics.facebook?console.debug("Skipping Facebook Analytics"):(t=window,s=document,e="script",t.fbq||(n=t.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)},t._fbq||(t._fbq=n),(n.push=n).loaded=!0,n.version="2.0",n.queue=[],(t=s.createElement(e)).async=!0,t.src="https://connect.facebook.net/en_US/fbevents.js",(s=s.getElementsByTagName(e)[0]).parentNode.insertBefore(t,s)),fbq("init",drupalSettings.neg_analytics.facebook.measurementId,{em:drupalSettings.neg_analytics.facebook.em}),events.registerHandler(new function(){const d=this;this.useBeacon="function"==typeof navigator.sendBeacon,this.conversionQueue=[],this.apiUrl=void 0!==drupalSettings.neg_analytics.track_url?drupalSettings.neg_analytics.track_url:null,this.send=function(e,n,t){fbq("track",n,t,{eventID:e}),d.sendToTrackingUrl(e,n,t)},this.unload=function(){var e;d.useBeacon&&0<d.conversionQueue.length&&(e=JSON.stringify(d.conversionQueue),navigator.sendBeacon(d.apiUrl,e),d.conversionQueue=[])},this.sendToTrackingUrl=function(e,n,t){if(d.apiUrl){n={event_name:n,event_time:Math.floor(Date.now()/1e3),event_id:e,event_source_url:window.location.href,action_source:"website",user_data:{client_user_agent:navigator.userAgent},custom_data:t};if(d.useBeacon)d.conversionQueue.push(n);else{const s=new XMLHttpRequest;e=JSON.stringify([n]);s.open("POST",d.apiUrl),s.setRequestHeader("Content-Type","application/json"),s.send(e)}}},this.processEvent=function(e,n,t){let s=[],a=0;switch(n){case"search":for(let e=0;e<t.items.length;e++){var i=t.items[e];s.push(i.sku)}d.send(e,"Search",{search_string:t.search_query,content_ids:s});break;case"view_item":for(let e=0;e<t.items.length;e++){var o=t.items[e];s.push(o.sku)}d.send(e,"ViewContent",{content_ids:s});break;case"view_item_list":for(let e=0;e<t.items.length;e++){var r=t.items[e];s.push(r.sku)}d.send(e,"ViewContent",{content_ids:s});break;case"addToCart":d.send(e,"AddToCart",{content_ids:[t.sku]});break;case"checkout":s=[];for(let e=a=0;e<t.items.length;e++){var c=t.items[e];s.push(c.sku),a+=c.qty}d.send(e,"InitiateCheckout",{content_ids:s,num_items:a});break;case"purchase":s=[];for(let e=a=0;e<t.items.length;e++){var u=t.items[e];s.push(u.sku),a+=u.qty}d.send(e,"Purchase",{content_ids:s,num_items:a,value:t.value,currency:t.currency})}},d.send("PageView_"+Math.floor(Math.random()*Date.now()),"PageView"),window.addEventListener("beforeunload",d.unload,!1),window.addEventListener("pagehide",d.unload,!1)}))}();
